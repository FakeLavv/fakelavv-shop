<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FakeLavv | SHOP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="/socket.io/socket.io.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', system-ui, sans-serif; }
        :root { --black: #000; --dark: #0a0a0a; --gray: #1a1a1a; --white: #fff; --badge-owner: #ff4444; --badge-creator: #ff8800; --badge-dev: #4488ff; --badge-sponsor: #ffdd00; --badge-premium: #aa44ff; --badge-buyer: #44ff88; --badge-vip: #ff44aa; --badge-mod: #44aaff; --badge-helper: #44ffaa; --badge-new: #666; }
        html { scroll-behavior: smooth; }
        body { background: var(--black); color: var(--white); min-height: 100vh; overflow-x: hidden; font-size: 14px; line-height: 1.6; }
        .cursor { position: fixed; width: 24px; height: 24px; border: 2px solid rgba(255,255,255,0.8); border-radius: 50%; z-index: 9999; pointer-events: none; transform: translate(-50%,-50%); transition: all 0.15s ease-out; mix-blend-mode: difference; display: none; }
        .cursor.hover { width: 50px; height: 50px; background: rgba(255,255,255,0.1); }
        .cursor.click { width: 15px; height: 15px; background: rgba(255,255,255,0.9); }
        .loader { position: fixed; inset: 0; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10000; transition: opacity 0.5s, visibility 0.5s; }
        .loader.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
        .loader-logo { font-size: 3rem; font-weight: 900; background: linear-gradient(90deg,#333,#888,#fff,#888,#333); background-size: 200% auto; -webkit-background-clip: text; background-clip: text; color: transparent; animation: shine 2s linear infinite; margin-bottom: 2rem; }
        @keyframes shine { to { background-position: 200% center; } }
        .loader-spinner { width: 50px; height: 50px; border: 3px solid rgba(255,255,255,0.1); border-top-color: #888; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loader-progress { width: 250px; height: 3px; background: rgba(255,255,255,0.1); border-radius: 2px; overflow: hidden; margin-top: 1.5rem; }
        .loader-progress-bar { height: 100%; background: linear-gradient(90deg,#444,#888); width: 0%; transition: width 0.2s; }
        #authModal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: flex; align-items: center; justify-content: center; z-index: 99999; backdrop-filter: blur(10px); }
        .auth-container { background: rgba(20,20,20,0.95); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 2.5rem; width: 90%; max-width: 400px; text-align: center; }
        .auth-container h2 { margin-bottom: 0.5rem; font-size: 1.8rem; }
        .auth-container p { color: #888; margin-bottom: 2rem; }
        .auth-form { display: none; flex-direction: column; gap: 1rem; }
        .auth-form.active { display: flex; }
        .auth-input { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); padding: 1rem; border-radius: 10px; color: #fff; font-size: 1rem; outline: none; transition: all 0.3s; }
        .auth-input:focus { border-color: rgba(255,255,255,0.3); background: rgba(255,255,255,0.08); }
        .auth-btn { background: linear-gradient(90deg,#444,#666); border: none; padding: 1rem; border-radius: 10px; color: #fff; font-weight: 700; cursor: pointer; transition: all 0.3s; }
        .auth-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(255,255,255,0.1); }
        .auth-toggle { margin-top: 1.5rem; color: #888; }
        .auth-toggle button { background: none; border: none; color: #fff; text-decoration: underline; cursor: pointer; margin-left: 0.5rem; }
        .auth-error { color: #ff4444; margin-top: 1rem; font-size: 0.9rem; min-height: 20px; }
        .navbar { position: fixed; top: 0; left: 0; right: 0; background: rgba(10,10,10,0.95); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255,255,255,0.1); padding: 1rem 2rem; z-index: 1000; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; animation: slideDown 0.6s ease; }
        @keyframes slideDown { from { transform: translateY(-100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .logo { font-size: 1.8rem; font-weight: 900; letter-spacing: 2px; background: linear-gradient(90deg,#fff,#888); -webkit-background-clip: text; background-clip: text; color: transparent; animation: pulse 2s ease-in-out infinite; }
        @keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.8; } }
        .nav-tabs { display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .nav-tab { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: #aaa; padding: 0.5rem 1rem; border-radius: 20px; transition: all 0.3s; font-size: 0.85rem; cursor: pointer; display: flex; align-items: center; gap: 0.5rem; position: relative; overflow: hidden; }
        .nav-tab::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg,transparent,rgba(255,255,255,0.1),transparent); transition: left 0.5s; }
        .nav-tab:hover::before { left: 100%; }
        .nav-tab:hover, .nav-tab.active { background: rgba(255,255,255,0.1); color: #fff; border-color: rgba(255,255,255,0.3); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .nav-tab.admin-tab { background: rgba(255,68,68,0.15); border-color: rgba(255,68,68,0.3); color: #ff8888; }
        .nav-tab.black-tab { background: rgba(139,0,0,0.3); border-color: rgba(139,0,0,0.5); color: #ff6666; }
        .nav-tab.black-tab:hover, .nav-tab.black-tab.active { background: rgba(139,0,0,0.5); border-color: #8b0000; color: #ff4444; }
        .user-menu { display: flex; align-items: center; gap: 1rem; }
        .cart-btn { position: relative; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s; }
        .cart-btn:hover { background: rgba(255,255,255,0.1); transform: scale(1.1); }
        .cart-count { position: absolute; top: -5px; right: -5px; background: #ff4444; color: #fff; font-size: 0.7rem; font-weight: 700; width: 20px; height: 20px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .logout-btn { background: rgba(255,68,68,0.2); border: 1px solid rgba(255,68,68,0.3); color: #ff8888; padding: 0.5rem 1rem; border-radius: 20px; cursor: pointer; transition: all 0.3s; }
        .logout-btn:hover { background: rgba(255,68,68,0.3); }
        .badge { display: inline-flex; align-items: center; gap: 0.3rem; padding: 0.2rem 0.6rem; border-radius: 12px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; border: 1px solid; box-shadow: 0 0 8px currentColor; line-height: 1.2; }
        .badge i { font-size: 0.65rem; }
        .badge-owner { border-color: var(--badge-owner); color: #ff6666; background: rgba(255,68,68,0.08); box-shadow: 0 0 8px rgba(255,68,68,0.4); }
        .badge-creator { border-color: var(--badge-creator); color: #ffaa44; background: rgba(255,136,0,0.08); box-shadow: 0 0 8px rgba(255,136,0,0.4); }
        .badge-dev { border-color: var(--badge-dev); color: #66aaff; background: rgba(68,136,255,0.08); box-shadow: 0 0 8px rgba(68,136,255,0.4); }
        .badge-sponsor { border-color: var(--badge-sponsor); color: #ffee44; background: rgba(255,221,0,0.08); box-shadow: 0 0 8px rgba(255,221,0,0.4); }
        .badge-premium { border-color: var(--badge-premium); color: #cc88ff; background: rgba(170,68,255,0.08); box-shadow: 0 0 8px rgba(170,68,255,0.4); }
        .badge-buyer { border-color: var(--badge-buyer); color: #66ffaa; background: rgba(68,255,136,0.08); box-shadow: 0 0 8px rgba(68,255,136,0.4); }
        .badge-vip { border-color: var(--badge-vip); color: #ff88cc; background: rgba(255,68,170,0.08); box-shadow: 0 0 8px rgba(255,68,170,0.4); }
        .badge-mod { border-color: var(--badge-mod); color: #88ccff; background: rgba(68,170,255,0.08); box-shadow: 0 0 8px rgba(68,170,255,0.4); }
        .badge-helper { border-color: var(--badge-helper); color: #88ffcc; background: rgba(68,255,170,0.08); box-shadow: 0 0 8px rgba(68,255,170,0.4); }
        .badge-new { border-color: var(--badge-new); color: #999; background: rgba(136,136,136,0.08); box-shadow: 0 0 8px rgba(136,136,136,0.3); }
        .badge-small { padding: 0.1rem 0.4rem; font-size: 0.6rem; }
        .container { max-width: 1200px; margin: 80px auto 0; padding: 2rem; }
        .tab-content { display: none; opacity: 0; transform: translateY(20px); transition: opacity 0.4s, transform 0.4s; }
        .tab-content.active { display: block; opacity: 1; transform: translateY(0); animation: fadeInUp 0.5s ease; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .section-title { text-align: center; font-size: 2.2rem; margin-bottom: 2rem; font-weight: 800; text-transform: uppercase; position: relative; padding-bottom: 1rem; animation: glow 2s ease-in-out infinite alternate; }
        @keyframes glow { from { text-shadow: 0 0 10px rgba(255,255,255,0.1); } to { text-shadow: 0 0 20px rgba(255,255,255,0.3), 0 0 30px rgba(255,255,255,0.1); } }
        .section-title::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 60px; height: 2px; background: linear-gradient(90deg,transparent,#888,transparent); }
        .hero { padding: 2rem 0; }
        .hero-content { display: flex; gap: 3rem; align-items: center; margin-bottom: 3rem; }
        @media (max-width: 900px) { .hero-content { flex-direction: column; } }
        .hero-text { flex: 1; animation: slideInLeft 0.8s ease; }
        @keyframes slideInLeft { from { opacity: 0; transform: translateX(-50px); } to { opacity: 1; transform: translateX(0); } }
        .hero-title { font-size: 3rem; font-weight: 900; margin-bottom: 1rem; background: linear-gradient(90deg,#fff,#888); -webkit-background-clip: text; background-clip: text; color: transparent; }
        .hero-subtitle { font-size: 1.3rem; color: #888; margin-bottom: 1.5rem; letter-spacing: 3px; text-transform: uppercase; }
        .hero-description { font-size: 1.1rem; color: #aaa; line-height: 1.8; padding-left: 1rem; border-left: 2px solid rgba(255,255,255,0.1); }
        .hero-highlight { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); padding: 2rem; border-radius: 15px; text-align: center; color: #bbb; font-style: italic; position: relative; overflow: hidden; animation: slideInUp 0.8s ease 0.2s both; }
        @keyframes slideInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .hero-highlight::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 2px; background: linear-gradient(90deg,transparent,#888,transparent); animation: scan 3s linear infinite; }
        @keyframes scan { 0% { left: -100%; } 100% { left: 100%; } }
        .user-profile { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 2rem; margin-bottom: 2rem; text-align: center; position: relative; overflow: hidden; }
        .user-profile::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg,var(--badge-owner),var(--badge-dev),var(--badge-premium)); }
        .user-avatar { width: 100px; height: 100px; border-radius: 50%; background: linear-gradient(135deg,#333,#555); margin: 0 auto 1rem; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; border: 3px solid rgba(255,255,255,0.1); position: relative; }
        .user-avatar::after { content: ''; position: absolute; inset: -5px; border-radius: 50%; border: 2px solid transparent; border-top-color: var(--badge-premium); border-right-color: var(--badge-dev); animation: avatar-rotate 4s linear infinite; }
        @keyframes avatar-rotate { to { transform: rotate(360deg); } }
        .user-name { font-size: 1.5rem; font-weight: 800; margin-bottom: 0.5rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem; flex-wrap: wrap; }
        .user-badges { display: flex; gap: 0.4rem; justify-content: center; flex-wrap: wrap; margin-top: 0.8rem; }
        .user-stats { display: grid; grid-template-columns: repeat(3,1fr); gap: 1rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1); }
        .user-stat { text-align: center; }
        .user-stat-value { font-size: 1.5rem; font-weight: 800; color: #fff; }
        .user-stat-label { font-size: 0.8rem; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        .music-player-main { flex: 0 0 400px; perspective: 1000px; animation: slideInRight 0.8s ease; }
        @keyframes slideInRight { from { opacity: 0; transform: translateX(50px); } to { opacity: 1; transform: translateX(0); } }
        .music-player { background: rgba(20,20,20,0.8); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 2rem; backdrop-filter: blur(10px); transform-style: preserve-3d; transition: transform 0.1s ease-out; will-change: transform; }
        .cover-container { width: 220px; height: 220px; margin: 0 auto 1.5rem; border-radius: 15px; overflow: hidden; border: 2px solid rgba(255,255,255,0.1); position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .cover-container.playing .cover-image { animation: rotate 10s linear infinite; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .cover-image { width: 100%; height: 100%; background-size: cover; background-position: center; border-radius: 15px; }
        .cover-image::after { content: ''; position: absolute; top: 50%; left: 50%; width: 50px; height: 50px; background: rgba(0,0,0,0.8); border-radius: 50%; transform: translate(-50%,-50%); border: 2px solid rgba(255,255,255,0.2); }
        .visualizer-container { display: flex; align-items: flex-end; justify-content: center; gap: 3px; height: 50px; margin: 1rem 0; padding: 0 1rem; }
        .visualizer-bar { width: 6px; background: linear-gradient(to top,rgba(255,255,255,0.8),rgba(255,255,255,0.2)); border-radius: 3px; transition: height 0.05s ease; min-height: 3px; max-height: 50px; }
        .track-info { text-align: center; margin-bottom: 1rem; }
        .track-title { font-size: 1.3rem; font-weight: 700; color: #fff; margin-bottom: 0.3rem; }
        .track-artist { color: #888; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 2px; }
        .progress-container { width: 100%; height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; margin: 1rem 0; cursor: pointer; position: relative; }
        .progress-bar { height: 100%; background: linear-gradient(90deg,#666,#fff); width: 0%; border-radius: 2px; transition: width 0.1s linear; box-shadow: 0 0 10px rgba(255,255,255,0.3); }
        .time-display { display: flex; justify-content: space-between; color: #666; font-size: 0.75rem; margin-bottom: 1rem; font-family: monospace; }
        .player-controls { display: flex; justify-content: center; align-items: center; gap: 1rem; margin-bottom: 1rem; }
        .control-btn { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: #fff; width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; font-size: 1.1rem; }
        .control-btn:hover { background: rgba(255,255,255,0.1); transform: scale(1.1); box-shadow: 0 0 20px rgba(255,255,255,0.1); }
        .play-btn { width: 60px; height: 60px; font-size: 1.3rem; animation: pulse-btn 2s ease-in-out infinite; }
        @keyframes pulse-btn { 0%,100% { box-shadow: 0 0 0 0 rgba(255,255,255,0.2); } 50% { box-shadow: 0 0 0 10px rgba(255,255,255,0); } }
        .volume-control { display: flex; align-items: center; gap: 0.8rem; }
        .volume-slider { flex: 1; height: 4px; -webkit-appearance: none; background: rgba(255,255,255,0.1); border-radius: 2px; outline: none; cursor: pointer; }
        .volume-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 14px; height: 14px; border-radius: 50%; background: #fff; cursor: pointer; box-shadow: 0 0 10px rgba(255,255,255,0.5); }
        .particles { position: fixed; inset: 0; z-index: -1; overflow: hidden; pointer-events: none; }
        .particle { position: absolute; width: 4px; height: 4px; background: rgba(255,255,255,0.1); border-radius: 50%; animation: float-particle 15s infinite; }
        @keyframes float-particle { 0%,100% { transform: translateY(100vh); opacity: 0; } 10% { opacity: 1; } 90% { opacity: 1; } 100% { transform: translateY(-100vh); opacity: 0; } }
        .chat-container { display: flex; height: 70vh; background: rgba(20,20,20,0.8); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; overflow: hidden; }
        .chat-sidebar { width: 280px; background: rgba(0,0,0,0.3); border-right: 1px solid rgba(255,255,255,0.1); padding: 1.5rem; display: flex; flex-direction: column; }
        .online-list { margin-top: auto; max-height: 300px; overflow-y: auto; }
        .online-title { font-size: 0.8rem; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .online-user { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; margin-bottom: 0.5rem; background: rgba(255,255,255,0.03); border-radius: 10px; font-size: 0.9rem; }
        .online-user .badge { margin-left: auto; }
        .chat-main { flex: 1; display: flex; flex-direction: column; }
        .chat-messages { flex: 1; overflow-y: auto; padding: 1.5rem; display: flex; flex-direction: column; gap: 1rem; }
        .chat-message { max-width: 80%; padding: 1rem; border-radius: 15px; animation: messageAppear 0.3s; word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; }
        @keyframes messageAppear { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .chat-message.own { align-self: flex-end; background: rgba(100,100,255,0.2); border: 1px solid rgba(100,100,255,0.3); }
        .chat-message.other { align-self: flex-start; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); }
        .chat-message-header { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; font-size: 0.85rem; flex-wrap: wrap; }
        .chat-message-username { font-weight: 700; color: #fff; }
        .chat-message-time { color: #666; font-size: 0.75rem; }
        .chat-message-text { color: #ddd; line-height: 1.5; word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; max-width: 100%; }
        .chat-input-area { display: flex; gap: 1rem; padding: 1.5rem; background: rgba(0,0,0,0.3); border-top: 1px solid rgba(255,255,255,0.1); }
        .chat-input { flex: 1; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); padding: 1rem; border-radius: 10px; color: #fff; font-size: 1rem; outline: none; }
        .chat-input:focus { border-color: rgba(255,255,255,0.3); }
        .chat-input:disabled { opacity: 0.5; cursor: not-allowed; }
        .chat-send-btn { background: linear-gradient(90deg,#444,#666); border: none; padding: 0 1.5rem; border-radius: 10px; color: #fff; cursor: pointer; transition: all 0.3s; }
        .chat-send-btn:hover { transform: scale(1.05); box-shadow: 0 5px 20px rgba(255,255,255,0.1); }
        .chat-send-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .chat-limit-info { padding: 0.5rem 1.5rem; background: rgba(0,0,0,0.3); border-top: 1px solid rgba(255,255,255,0.05); font-size: 0.8rem; color: #666; text-align: center; }
        .chat-limit-warning { color: #ffaa44; }
        .chat-limit-blocked { color: #ff4444; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(280px,1fr)); gap: 1.5rem; margin-top: 2rem; }
        .product-card { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 15px; padding: 1.8rem; text-align: center; transition: all 0.3s; transform-style: preserve-3d; }
        .product-card:hover { transform: perspective(1000px) rotateX(2deg) rotateY(2deg) scale3d(1.02,1.02,1.02); box-shadow: 0 20px 40px rgba(0,0,0,0.4); border-color: rgba(255,255,255,0.15); }
        .product-card.black-card { background: rgba(139,0,0,0.1); border-color: rgba(139,0,0,0.3); }
        .product-card.black-card:hover { border-color: rgba(139,0,0,0.5); box-shadow: 0 20px 40px rgba(139,0,0,0.3); }
        .product-icon { font-size: 3rem; margin-bottom: 1rem; color: #888; }
        .product-card.black-card .product-icon { color: #ff6666; }
        .product-title { font-size: 1.3rem; font-weight: 700; margin-bottom: 0.5rem; }
        .product-card.black-card .product-title { color: #ff6666; }
        .product-desc { color: #888; font-size: 0.9rem; margin-bottom: 1rem; line-height: 1.5; }
        .product-price { font-size: 1.5rem; font-weight: 800; color: #fff; margin-bottom: 1rem; }
        .product-card.black-card .product-price { color: #ff4444; }
        .add-to-cart-btn { background: linear-gradient(90deg,#444,#666); border: none; padding: 0.8rem 1.5rem; border-radius: 25px; color: #fff; font-weight: 700; cursor: pointer; transition: all 0.3s; width: 100%; }
        .add-to-cart-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(255,255,255,0.1); }
        .product-card.black-card .add-to-cart-btn { background: linear-gradient(90deg,#8b0000,#ff4444); }
        .faq-grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(350px,1fr)); gap: 1.5rem; margin-top: 2rem; }
        .faq-card { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 20px; padding: 1.8rem; transition: all 0.4s; }
        .faq-card:hover { transform: translateY(-5px); border-color: rgba(255,255,255,0.15); box-shadow: 0 15px 30px rgba(0,0,0,0.3); }
        .faq-card h3 { color: #fff; margin-bottom: 1rem; display: flex; align-items: center; gap: 1rem; font-size: 1.2rem; }
        .faq-card h3 i { color: #888; }
        .faq-card p { color: #aaa; line-height: 1.6; }
        .contacts-grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(250px,1fr)); gap: 1.5rem; margin-top: 2rem; }
        .contact-card { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 15px; padding: 2rem; text-align: center; transition: all 0.3s; text-decoration: none; color: #fff; display: block; }
        .contact-card:hover { transform: translateY(-5px); border-color: rgba(255,255,255,0.15); box-shadow: 0 15px 30px rgba(0,0,0,0.3); }
        .contact-icon { font-size: 2.5rem; margin-bottom: 1rem; color: #888; }
        .contact-title { font-size: 1.2rem; font-weight: 700; margin-bottom: 0.5rem; }
        .contact-value { color: #888; font-size: 0.9rem; }
        .cart-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); z-index: 9999; display: none; align-items: center; justify-content: center; }
        .cart-modal.active { display: flex; }
        .cart-container { background: rgba(20,20,20,0.95); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; width: 90%; max-width: 500px; max-height: 80vh; overflow: hidden; display: flex; flex-direction: column; }
        .cart-header { padding: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center; }
        .cart-header h2 { margin: 0; }
        .cart-close { background: none; border: none; color: #888; font-size: 1.5rem; cursor: pointer; transition: color 0.3s; }
        .cart-close:hover { color: #fff; }
        .cart-items { flex: 1; overflow-y: auto; padding: 1.5rem; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 10px; margin-bottom: 1rem; }
        .cart-item-info h4 { margin: 0 0 0.3rem 0; }
        .cart-item-info p { margin: 0; color: #888; font-size: 0.9rem; }
        .cart-item-remove { background: rgba(255,68,68,0.2); border: none; color: #ff8888; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; transition: all 0.3s; }
        .cart-item-remove:hover { background: rgba(255,68,68,0.4); }
        .cart-footer { padding: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1); }
        .cart-total { display: flex; justify-content: space-between; font-size: 1.3rem; font-weight: 700; margin-bottom: 1rem; }
        .checkout-btn { background: linear-gradient(90deg,#444,#666); border: none; padding: 1rem; border-radius: 10px; color: #fff; font-weight: 700; cursor: pointer; width: 100%; transition: all 0.3s; }
        .checkout-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(255,255,255,0.1); }
        .empty-cart { text-align: center; color: #888; padding: 3rem; }
        .admin-users-panel { background: rgba(20,20,20,0.8); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; overflow: hidden; }
        .admin-users-header { padding: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; }
        .admin-users-stats { display: flex; gap: 2rem; color: #888; }
        .admin-users-stats b { color: #fff; }
        .admin-users-list { max-height: 60vh; overflow-y: auto; padding: 1rem; }
        .admin-user-card { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 15px; padding: 1.5rem; margin-bottom: 1rem; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; }
        .admin-user-info { display: flex; align-items: center; gap: 1rem; }
        .admin-user-avatar { width: 50px; height: 50px; border-radius: 50%; background: linear-gradient(135deg,#333,#555); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; }
        .admin-user-details h4 { margin: 0 0 0.3rem 0; display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap; }
        .admin-user-details p { margin: 0; color: #888; font-size: 0.85rem; }
        .admin-user-actions { display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .admin-btn { padding: 0.5rem 1rem; border-radius: 20px; border: none; cursor: pointer; font-size: 0.8rem; transition: all 0.3s; }
        .admin-btn-ban { background: rgba(255,68,68,0.2); color: #ff8888; border: 1px solid rgba(255,68,68,0.3); }
        .admin-btn-mute { background: rgba(255,170,0,0.2); color: #ffaa44; border: 1px solid rgba(255,170,0,0.3); }
        .admin-btn-delete { background: rgba(255,0,0,0.2); color: #ff6666; border: 1px solid rgba(255,0,0,0.3); }
        .admin-btn-badge { background: rgba(170,68,255,0.2); color: #cc88ff; border: 1px solid rgba(170,68,255,0.3); }
        .admin-btn:hover { transform: scale(1.05); filter: brightness(1.2); }
        .online-indicator { width: 8px; height: 8px; background: #44ff88; border-radius: 50%; display: inline-block; margin-right: 0.5rem; box-shadow: 0 0 10px #44ff88; }
        .badge-select-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); z-index: 10000; display: none; align-items: center; justify-content: center; }
        .badge-select-modal.active { display: flex; }
        .badge-select-container { background: rgba(20,20,20,0.95); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 2rem; width: 90%; max-width: 400px; max-height: 80vh; overflow-y: auto; }
        .badge-select-title { text-align: center; margin-bottom: 1.5rem; font-size: 1.3rem; }
        .badge-select-grid { display: grid; grid-template-columns: repeat(2,1fr); gap: 0.8rem; margin-bottom: 1.5rem; }
        .badge-select-item { padding: 0.8rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; cursor: pointer; transition: all 0.3s; text-align: center; }
        .badge-select-item:hover { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.3); }
        .badge-select-item.selected { background: rgba(100,100,255,0.2); border-color: rgba(100,100,255,0.5); }
        .badge-select-actions { display: flex; gap: 1rem; }
        .badge-select-btn { flex: 1; padding: 0.8rem; border-radius: 10px; border: none; cursor: pointer; font-weight: 700; transition: all 0.3s; }
        .badge-select-btn.give { background: linear-gradient(90deg,#444,#666); color: #fff; }
        .badge-select-btn.remove { background: rgba(255,68,68,0.2); color: #ff8888; border: 1px solid rgba(255,68,68,0.3); }
        .badge-select-btn.cancel { background: rgba(255,255,255,0.05); color: #888; border: 1px solid rgba(255,255,255,0.1); }
        .badges-info { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 2rem; margin-top: 2rem; }
        .badges-grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(200px,1fr)); gap: 1rem; margin-top: 1.5rem; }
        .badge-item { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 15px; padding: 1.5rem; text-align: center; transition: all 0.3s; }
        .badge-item:hover { transform: translateY(-3px); border-color: rgba(255,255,255,0.15); }
        .badge-item .badge { margin-bottom: 0.5rem; }
        .badge-desc { color: #888; font-size: 0.85rem; margin-top: 0.5rem; }
        
        /* Reviews Styles */
        .reviews-section { max-width: 1200px; margin: 2rem auto 0; }
        .reviews-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; margin-bottom: 3rem; }
        .review-card { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 15px; padding: 1.5rem; transition: all 0.3s ease; backdrop-filter: blur(5px); }
        .review-card:hover { border-color: rgba(255, 255, 255, 0.15); transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); }
        .review-card.admin-review { border-color: rgba(255, 215, 0, 0.3); background: rgba(255, 215, 0, 0.05); }
        .review-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .review-user { display: flex; align-items: center; gap: 0.8rem; }
        .review-avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #333, #555); display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .review-username { font-weight: 700; color: #fff; }
        .review-date { font-size: 0.75rem; color: #666; }
        .review-rating { display: flex; gap: 0.2rem; }
        .review-rating .star { color: #ffd700; font-size: 1rem; }
        .review-rating .star.empty { color: #444; }
        .review-text { color: #ccc; line-height: 1.6; margin-top: 0.5rem; }
        .review-actions { display: flex; gap: 0.5rem; margin-top: 1rem; }
        .review-btn { padding: 0.4rem 0.8rem; border-radius: 15px; border: none; font-size: 0.75rem; cursor: pointer; transition: all 0.3s; }
        .review-btn.edit { background: rgba(100, 150, 255, 0.2); color: #88aaff; border: 1px solid rgba(100, 150, 255, 0.3); }
        .review-btn.delete { background: rgba(255, 68, 68, 0.2); color: #ff8888; border: 1px solid rgba(255, 68, 68, 0.3); }
        .review-btn:hover { transform: scale(1.05); filter: brightness(1.2); }
        
        .add-review-form { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 2rem; margin-bottom: 2rem; max-width: 600px; margin-left: auto; margin-right: auto; }
        .add-review-form h3 { text-align: center; margin-bottom: 1.5rem; color: #fff; }
        .rating-input { display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 1.5rem; }
        .rating-input .star-btn { background: none; border: none; color: #444; font-size: 2rem; cursor: pointer; transition: all 0.2s; }
        .rating-input .star-btn:hover, .rating-input .star-btn.active { color: #ffd700; transform: scale(1.2); }
        .review-textarea { width: 100%; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; padding: 1rem; color: #fff; font-size: 1rem; resize: vertical; min-height: 100px; margin-bottom: 1rem; }
        .review-textarea:focus { outline: none; border-color: rgba(255, 255, 255, 0.3); }
        .submit-review-btn { width: 100%; background: linear-gradient(90deg, #444, #666); border: none; padding: 1rem; border-radius: 10px; color: #fff; font-weight: 700; cursor: pointer; transition: all 0.3s; }
        .submit-review-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(255, 255, 255, 0.1); }
        .submit-review-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .reviews-stats { display: flex; justify-content: center; gap: 3rem; margin-bottom: 2rem; flex-wrap: wrap; }
        .reviews-stat { text-align: center; }
        .reviews-stat-value { font-size: 2.5rem; font-weight: 800; color: #fff; }
        .reviews-stat-label { font-size: 0.9rem; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        
        .edit-review-modal { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.9); backdrop-filter: blur(10px); z-index: 10001; display: none; align-items: center; justify-content: center; }
        .edit-review-modal.active { display: flex; }
        .edit-review-container { background: rgba(20, 20, 20, 0.95); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 2rem; width: 90%; max-width: 500px; }
        .edit-review-container h3 { text-align: center; margin-bottom: 1.5rem; }
        .edit-rating-input { display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 1rem; }
        .edit-rating-input .star-btn { background: none; border: none; color: #444; font-size: 1.5rem; cursor: pointer; transition: all 0.2s; }
        .edit-rating-input .star-btn:hover, .edit-rating-input .star-btn.active { color: #ffd700; }
        .edit-review-actions { display: flex; gap: 1rem; margin-top: 1.5rem; }
        .edit-review-actions button { flex: 1; padding: 0.8rem; border-radius: 10px; border: none; cursor: pointer; font-weight: 700; transition: all 0.3s; }
        .save-edit-btn { background: linear-gradient(90deg, #444, #666); color: #fff; }
        .cancel-edit-btn { background: rgba(255, 255, 255, 0.05); color: #888; border: 1px solid rgba(255, 255, 255, 0.1); }
        
        @media (max-width: 768px) { .cursor { display: none !important; } .hero-content { flex-direction: column; } .music-player-main { flex: 1; width: 100%; } .navbar { padding: 1rem; } .chat-container { flex-direction: column; height: 60vh; } .chat-sidebar { width: 100%; border-right: none; border-bottom: 1px solid rgba(255,255,255,0.1); } .admin-users-header { flex-direction: column; text-align: center; } .admin-user-card { flex-direction: column; text-align: center; } .chat-message { max-width: 95%; } .reviews-grid { grid-template-columns: 1fr; } .reviews-stats { gap: 1.5rem; } }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>
    <div class="cursor" id="cursor"></div>
    <div class="loader" id="loader">
        <div class="loader-logo">FAKELAVV</div>
        <div class="loader-spinner"></div>
        <div class="loader-progress"><div class="loader-progress-bar" id="progressBar"></div></div>
    </div>
    <div id="authModal" style="display: none;">
        <div class="auth-container">
            <h2>FAKELAVV SHOP</h2>
            <p>Войдите или создайте аккаунт</p>
            <form id="loginForm" class="auth-form active">
                <input type="text" id="loginUsername" class="auth-input" placeholder="Имя пользователя" required minlength="3">
                <input type="password" id="loginPassword" class="auth-input" placeholder="Пароль" required minlength="6">
                <button type="submit" class="auth-btn">Войти</button>
            </form>
            <form id="registerForm" class="auth-form">
                <input type="text" id="regUsername" class="auth-input" placeholder="Имя пользователя" required minlength="3" maxlength="20">
                <input type="email" id="regEmail" class="auth-input" placeholder="Email" required>
                <input type="password" id="regPassword" class="auth-input" placeholder="Пароль (мин. 6 символов)" required minlength="6">
                <button type="submit" class="auth-btn">Создать аккаунт</button>
            </form>
            <div class="auth-toggle"><span id="toggleText">Нет аккаунта?</span><button type="button" id="toggleBtn">Зарегистрироваться</button></div>
            <div class="auth-error" id="authError"></div>
        </div>
    </div>
    <div id="mainApp" style="display: none;">
        <nav class="navbar">
            <div class="logo">FAKELAVV</div>
            <div class="nav-tabs" id="navTabs">
                <button class="nav-tab active" data-tab="home"><i class="fas fa-home"></i> Главная</button>
                <button class="nav-tab" data-tab="chat"><i class="fas fa-comments"></i> Чат</button>
                <button class="nav-tab" data-tab="programming"><i class="fas fa-code"></i> Программирование</button>
                <button class="nav-tab" data-tab="design"><i class="fas fa-paint-brush"></i> Дизайн</button>
                <button class="nav-tab black-tab" data-tab="black"><i class="fas fa-skull"></i> Чёрнуха</button>
                <button class="nav-tab" data-tab="faq"><i class="fas fa-question-circle"></i> FAQ</button>
                <button class="nav-tab" data-tab="packets"><i class="fas fa-gift"></i> Пакеты</button>
                <button class="nav-tab" data-tab="reviews"><i class="fas fa-star"></i> Оценка</button>
                <button class="nav-tab" data-tab="badges"><i class="fas fa-medal"></i> Бейджики</button>
                <button class="nav-tab" data-tab="contacts"><i class="fas fa-phone"></i> Контакты</button>
            </div>
            <div class="user-menu">
                <div class="cart-btn" id="cartBtn"><i class="fas fa-shopping-cart"></i><div class="cart-count" id="cartCount">0</div></div>
                <button class="logout-btn" onclick="logout()"><i class="fas fa-sign-out-alt"></i></button>
            </div>
        </nav>
        <div class="container">
            <div class="tab-content active" id="home">
                <div class="hero">
                    <div class="user-profile">
                        <div class="user-avatar"><i class="fas fa-user"></i></div>
                        <div class="user-name" id="profileName">User</div>
                        <div class="user-badges" id="profileBadges"></div>
                        <div class="user-stats">
                            <div class="user-stat"><div class="user-stat-value" id="statMessages">0</div><div class="user-stat-label">Сообщений</div></div>
                            <div class="user-stat"><div class="user-stat-value" id="statPurchases">0</div><div class="user-stat-label">Покупок</div></div>
                            <div class="user-stat"><div class="user-stat-value" id="statBadges">1</div><div class="user-stat-label">Бейджиков</div></div>
                        </div>
                    </div>
                    <div class="hero-content">
                        <div class="hero-text">
                            <h1 class="hero-title">FakeLavv SHOP</h1>
                            <div class="hero-subtitle">OSINT-специалист и Музыкант</div>
                            <div class="hero-description">Я предлагаю широкий спектр услуг по разработке и ведению ваших проектов. Мои решения помогут автоматизировать процессы, повысить безопасность и разнообразить взаимодействие с пользователями.</div>
                        </div>
                        <div class="music-player-main" id="playerContainer">
                            <div class="music-player" id="musicPlayer">
                                <div class="cover-container" id="coverContainer"><div class="cover-image" id="coverImage"></div></div>
                                <div class="visualizer-container" id="visualizer"></div>
                                <div class="track-info"><div class="track-title" id="trackTitle">Загрузка...</div><div class="track-artist" id="trackArtist">FakeLavv</div></div>
                                <div class="time-display"><span id="currentTime">0:00</span><span id="duration">0:00</span></div>
                                <div class="progress-container" id="progressContainer"><div class="progress-bar" id="progressBarPlayer"></div></div>
                                <div class="player-controls">
                                    <button class="control-btn" id="prevBtn"><i class="fas fa-step-backward"></i></button>
                                    <button class="control-btn play-btn" id="playBtn"><i class="fas fa-play" id="playIcon"></i></button>
                                    <button class="control-btn" id="nextBtn"><i class="fas fa-step-forward"></i></button>
                                </div>
                                <div class="volume-control"><i class="fas fa-volume-up" id="volumeIcon"></i><input type="range" min="0" max="100" value="70" class="volume-slider" id="volumeSlider"></div>
                            </div>
                        </div>
                    </div>
                    <div class="hero-highlight"><p>Профессиональные услуги в области цифровой безопасности, разработки и анализа. Индивидуальный подход к каждому проекту, гарантия качества и полная анонимность.</p></div>
                </div>
            </div>
            <div class="tab-content" id="chat">
                <h2 class="section-title">Общий Чат</h2>
                <div class="chat-container">
                    <div class="chat-sidebar">
                        <div>
                            <h3 style="margin-bottom: 1rem;">Ваш профиль</h3>
                            <div style="color: #888; margin-bottom: 0.5rem;">Ваш ID</div>
                            <div style="font-weight: 700; margin-bottom: 0.5rem;" id="chatUsername">User</div>
                            <div class="user-badges" id="chatBadges" style="justify-content: flex-start;"></div>
                        </div>
                        <div class="online-list">
                            <div class="online-title">Сейчас онлайн (<span id="onlineCount">0</span>)</div>
                            <div id="onlineList"></div>
                        </div>
                    </div>
                    <div class="chat-main">
                        <div class="chat-messages" id="chatMessages"></div>
                        <div class="chat-input-area">
                            <input type="text" class="chat-input" id="chatInput" placeholder="Написать сообщение..." maxlength="200">
                            <button class="chat-send-btn" id="sendBtn"><i class="fas fa-paper-plane"></i></button>
                        </div>
                        <div class="chat-limit-info" id="chatLimitInfo">Осталось сообщений: <span id="messagesLeft">5</span>/5 | Пауза: <span id="cooldownTime">0</span>с</div>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="programming">
                <h2 class="section-title">Программирование</h2>
                <div class="products-grid" id="programmingProducts"></div>
            </div>
            <div class="tab-content" id="design">
                <h2 class="section-title">Дизайн</h2>
                <div class="products-grid" id="designProducts"></div>
            </div>
            <div class="tab-content" id="black">
                <h2 class="section-title" style="color: #ff4444;">Чёрнуха</h2>
                <div class="products-grid" id="blackProducts"></div>
            </div>
            <div class="tab-content" id="faq">
                <h2 class="section-title">FAQ</h2>
                <div class="faq-grid" id="faqGrid"></div>
            </div>
            <div class="tab-content" id="packets">
                <h2 class="section-title">Пакеты</h2>
                <div class="products-grid" id="packetsProducts"></div>
            </div>
            <div class="tab-content" id="reviews">
                <h2 class="section-title">Оценка и Отзывы</h2>
                <div class="reviews-stats">
                    <div class="reviews-stat">
                        <div class="reviews-stat-value" id="avgRating">0.0</div>
                        <div class="reviews-stat-label">Средняя оценка</div>
                    </div>
                    <div class="reviews-stat">
                        <div class="reviews-stat-value" id="totalReviews">0</div>
                        <div class="reviews-stat-label">Всего отзывов</div>
                    </div>
                    <div class="reviews-stat">
                        <div class="reviews-stat-value" id="fiveStarPercent">0%</div>
                        <div class="reviews-stat-label">5 звёзд</div>
                    </div>
                </div>
                <div class="add-review-form" id="addReviewForm">
                    <h3>Оставить отзыв</h3>
                    <div class="rating-input" id="ratingInput">
                        <button class="star-btn" data-rating="1"><i class="fas fa-star"></i></button>
                        <button class="star-btn" data-rating="2"><i class="fas fa-star"></i></button>
                        <button class="star-btn" data-rating="3"><i class="fas fa-star"></i></button>
                        <button class="star-btn" data-rating="4"><i class="fas fa-star"></i></button>
                        <button class="star-btn" data-rating="5"><i class="fas fa-star"></i></button>
                    </div>
                    <textarea class="review-textarea" id="reviewText" placeholder="Напишите ваш отзыв... (необязательно)" maxlength="500"></textarea>
                    <button class="submit-review-btn" id="submitReviewBtn" onclick="submitReview()">Отправить отзыв</button>
                </div>
                <div class="reviews-grid" id="reviewsGrid"></div>
            </div>
            <div class="tab-content" id="badges">
                <h2 class="section-title">Система Бейджиков</h2>
                <div class="user-profile">
                    <div class="user-avatar" style="width: 80px; height: 80px; font-size: 2rem;"><i class="fas fa-user"></i></div>
                    <div class="user-name" id="badgesPageName">User</div>
                    <div class="user-badges" id="badgesPageBadges"></div>
                </div>
                <div class="badges-info">
                    <h3>Доступные бейджики</h3>
                    <div class="badges-grid" id="badgesGrid"></div>
                </div>
            </div>
            <div class="tab-content" id="users">
                <h2 class="section-title">Управление Пользователями</h2>
                <div class="admin-users-panel">
                    <div class="admin-users-header">
                        <div class="admin-users-title"><i class="fas fa-users-cog" style="color: #ff4444;"></i> Все пользователи</div>
                        <div class="admin-users-stats"><span>Всего: <b id="totalUsers">0</b></span><span>Онлайн: <b id="onlineUsersCount">0</b></span><span>Забанено: <b id="bannedUsersCount">0</b></span></div>
                    </div>
                    <div class="admin-users-list" id="adminUsersList"></div>
                </div>
            </div>
            <div class="tab-content" id="contacts">
                <h2 class="section-title">Контакты</h2>
                <div class="contacts-grid" id="contactsGrid"></div>
            </div>
        </div>
    </div>
    <div class="cart-modal" id="cartModal">
        <div class="cart-container">
            <div class="cart-header"><h2><i class="fas fa-shopping-cart"></i> Корзина</h2><button class="cart-close" onclick="closeCart()"><i class="fas fa-times"></i></button></div>
            <div class="cart-items" id="cartItems"><div class="empty-cart">Корзина пуста</div></div>
            <div class="cart-footer">
                <div class="cart-total"><span>Итого:</span><span id="cartTotal">0 ₽</span></div>
                <button class="checkout-btn" onclick="checkout()">Оформить заказ</button>
            </div>
        </div>
    </div>
    <div class="badge-select-modal" id="badgeSelectModal">
        <div class="badge-select-container">
            <div class="badge-select-title">Выдать бейджик</div>
            <div class="badge-select-grid" id="badgeSelectGrid"></div>
            <div class="badge-select-actions">
                <button class="badge-select-btn give" onclick="giveSelectedBadge()">Выдать</button>
                <button class="badge-select-btn remove" onclick="removeSelectedBadge()">Забрать</button>
                <button class="badge-select-btn cancel" onclick="closeBadgeModal()">Отмена</button>
            </div>
        </div>
    </div>
    <div class="edit-review-modal" id="editReviewModal">
        <div class="edit-review-container">
            <h3>Редактировать отзыв</h3>
            <div class="edit-rating-input" id="editRatingInput">
                <button class="star-btn" data-rating="1"><i class="fas fa-star"></i></button>
                <button class="star-btn" data-rating="2"><i class="fas fa-star"></i></button>
                <button class="star-btn" data-rating="3"><i class="fas fa-star"></i></button>
                <button class="star-btn" data-rating="4"><i class="fas fa-star"></i></button>
                <button class="star-btn" data-rating="5"><i class="fas fa-star"></i></button>
            </div>
            <textarea class="review-textarea" id="editReviewText" placeholder="Комментарий..." maxlength="500"></textarea>
            <div class="edit-review-actions">
                <button class="save-edit-btn" onclick="saveReviewEdit()">Сохранить</button>
                <button class="cancel-edit-btn" onclick="closeEditReviewModal()">Отмена</button>
            </div>
        </div>
    </div>
    <script>
        const playlist=[{title:"FakeLavv - Передоз",artist:"FakeLavv",cover:"https://cdn.discordapp.com/attachments/1446528538684686541/1450312195547205672/cover.jpg",audio:"music/1.mp3"},{title:"FakeLavv - Ганджа",artist:"FakeLavv",cover:"https://cdn.discordapp.com/attachments/1446528538684686541/1450312195547205672/cover.jpg",audio:"music/2.mp3"},{title:"FakeLavv - Больно",artist:"FakeLavv",cover:"https://cdn.discordapp.com/attachments/1446528538684686541/1450312195547205672/cover.jpg",audio:"music/3.mp3"},{title:"FakeLavv - кровавый",artist:"FakeLavv",cover:"https://cdn.discordapp.com/attachments/1446528538684686541/1450312195547205672/cover.jpg",audio:"music/4.mp3"},{title:"FakeLavv - Never sober",artist:"FakeLavv",cover:"https://cdn.discordapp.com/attachments/1446528538684686541/1450312195547205672/cover.jpg",audio:"music/5.mp3"}];
        const products={programming:[{id:'p1',icon:'fa-robot',title:'Discord бот',desc:'Автоматизация сервера, модерация, игры, музыка',price:450},{id:'p2',icon:'fa-paper-plane',title:'Telegram бот',desc:'Бот для бизнеса, рассылки, автоматизация',price:400},{id:'p3',icon:'fa-globe',title:'Веб-сайт',desc:'Лендинг, магазин, портфолио под ключ',price:1200},{id:'p4',icon:'fa-desktop',title:'Desktop приложение',desc:'Программа для Windows/Linux/Mac',price:1800},{id:'p5',icon:'fa-gamepad',title:'Чит для игры',desc:'Приватный чит под вашу игру',price:800},{id:'p6',icon:'fa-server',title:'Хостинг 24/7',desc:'Надежный хостинг для ботов и сайтов',price:250},{id:'p7',icon:'fa-shield-alt',title:'Аудит безопасности',desc:'Проверка сайта/бота на уязвимости',price:600},{id:'p8',icon:'fa-database',title:'Парсер данных',desc:'Сбор данных с любых сайтов',price:900}],design:[{id:'d1',icon:'fa-image',title:'Аватарка',desc:'Уникальная аватарка для соцсетей',price:250},{id:'d2',icon:'fa-paint-brush',title:'Баннер',desc:'Оформление для YouTube/Twitter/Discord',price:350},{id:'d3',icon:'fa-palette',title:'Тема оформления',desc:'Полный комплект: аватарка + баннер + превью',price:800},{id:'d4',icon:'fa-film',title:'Оформление видео',desc:'Интро, аутро, переходы для видео',price:600},{id:'d5',icon:'fa-music',title:'Обложка трека',desc:'Обложка для музыкального трека',price:400},{id:'d6',icon:'fa-ad',title:'Рекламный баннер',desc:'Баннер для рекламы в соцсетях',price:500},{id:'d7',icon:'fa-file-alt',title:'Дизайн документа',desc:'Презентация, резюме, коммерческое предложение',price:700},{id:'d8',icon:'fa-icons',title:'Иконки',desc:'Набор иконок для приложения/сайта',price:550}],packets:[{id:'pack1',icon:'fa-rocket',title:'Стартовый',desc:'Telegram бот + Аватарка + Хостинг 1 мес',price:900},{id:'pack2',icon:'fa-fire',title:'Бизнес',desc:'Сайт + Бот + Дизайн + Хостинг 3 мес',price:2200},{id:'pack3',icon:'fa-crown',title:'Премиум',desc:'Всё включено + Поддержка 24/7',price:2500}],black:[{id:'b1',icon:'fa-user-secret',title:'Полный пробив',desc:'Детальная информация по всем доступным источникам',price:1000},{id:'b2',icon:'fa-phone-volume',title:'Сватинг',desc:'Организованный вызов экстренных служб',price:1500},{id:'b3',icon:'fa-user-slash',title:'Снос аккаунта',desc:'Полное удаление аккаунта в соцсетях',price:2000},{id:'b4',icon:'fa-shield-virus',title:'Защита от доксеров',desc:'Комплексная защита от троллей и доксеров',price:1500},{id:'b5',icon:'fa-fist-raised',title:'Физическое воздействие',desc:'Организация встречи для выяснения отношений',price:5000},{id:'b6',icon:'fa-comment-dots',title:'Таргетированный троллинг',desc:'Систематический троллинг цели в соцсетях',price:250},{id:'b7',icon:'fa-sim-card',title:'Физические номера',desc:'SIM-карты для регистрации аккаунтов',price:100},{id:'b8',icon:'fa-graduation-cap',title:'Обучение',desc:'Полное обучение OSINT и безопасности',price:5000}]};
        const contacts=[{icon:'fa-telegram',title:'Telegram',value:'@fakelavv',url:'https://t.me/fakelavv'},{icon:'fa-envelope',title:'Email',value:'fakelavv@proton.me',url:'mailto:fakelavv@proton.me'},{icon:'fa-github',title:'GitHub',value:'github.com/fakelavv',url:'#'},{icon:'fa-bitcoin',title:'Crypto',value:'BTC/USDT',url:'#'}];
        const badgeInfo={owner:{name:'Owner',desc:'Владелец проекта',icon:'fa-crown'},creator:{name:'Creator',desc:'Создатель контента',icon:'fa-pen-nib'},dev:{name:'Developer',desc:'Разработчик',icon:'fa-code'},sponsor:{name:'Sponsor',desc:'Спонсор',icon:'fa-gem'},premium:{name:'Premium',desc:'Премиум пользователь',icon:'fa-star'},buyer:{name:'Buyer',desc:'Покупатель',icon:'fa-shopping-bag'},vip:{name:'VIP',desc:'VIP статус',icon:'fa-bolt'},mod:{name:'Moderator',desc:'Модератор',icon:'fa-gavel'},helper:{name:'Helper',desc:'Помощник',icon:'fa-hands-helping'},new:{name:'New',desc:'Новый пользователь',icon:'fa-seedling'}};
        const CHAT_LIMIT=5,CHAT_COOLDOWN=10;let messagesRemaining=CHAT_LIMIT,cooldownActive=false,cooldownInterval=null,lastMessageTime=0;
        let currentUser=null,socket=null,cart=JSON.parse(localStorage.getItem('cart'))||[],currentTrack=0,isPlaying=false,audio=null,audioContext=null,analyser=null,messageCount=0,selectedUserForBadge=null,selectedBadge=null;
        let selectedRating=0,editingReviewId=null;
        const urlRegex = /(https?:\/\/[^\s]+)|(www\.[^\s]+)|([a-zA-Z0-9-]+\.[a-zA-Z]{2,}[^\s]*)/gi;
        
        document.addEventListener('DOMContentLoaded',()=>{initParticles();initLoader();initCursor();checkAuth();initAuthForms();});
        function initParticles(){const c=document.getElementById('particles');for(let i=0;i<20;i++){const p=document.createElement('div');p.className='particle';p.style.left=Math.random()*100+'%';p.style.animationDelay=Math.random()*15+'s';p.style.animationDuration=(10+Math.random()*10)+'s';c.appendChild(p);}}
        function initLoader(){const b=document.getElementById('progressBar');let p=0;const i=setInterval(()=>{p+=Math.random()*15+10;if(p>100)p=100;b.style.width=p+'%';if(p>=100){clearInterval(i);setTimeout(()=>document.getElementById('loader').classList.add('hidden'),300);}},100);}
        function initCursor(){if(window.matchMedia('(pointer: coarse)').matches){return;}const c=document.getElementById('cursor');c.style.display='block';let mx=0,my=0,cx=0,cy=0,rafId=null,lastMove=Date.now();document.addEventListener('mousemove',e=>{mx=e.clientX;my=e.clientY;lastMove=Date.now();if(!rafId){rafId=requestAnimationFrame(animateCursor);}},{passive:true});document.addEventListener('mousedown',()=>c.classList.add('click'));document.addEventListener('mouseup',()=>c.classList.remove('click'));function animateCursor(){if(Date.now()-lastMove>100){rafId=null;return;}cx+=(mx-cx)*0.2;cy+=(my-cy)*0.2;c.style.left=cx+'px';c.style.top=cy+'px';rafId=requestAnimationFrame(animateCursor);}}
        function initAuthForms(){const l=document.getElementById('loginForm'),r=document.getElementById('registerForm'),t=document.getElementById('toggleBtn'),x=document.getElementById('toggleText');t.addEventListener('click',()=>{if(l.classList.contains('active')){l.classList.remove('active');r.classList.add('active');x.textContent='Уже есть аккаунт?';t.textContent='Войти';}else{r.classList.remove('active');l.classList.add('active');x.textContent='Нет аккаунта?';t.textContent='Зарегистрироваться';}});l.addEventListener('submit',async e=>{e.preventDefault();const u=document.getElementById('loginUsername').value,p=document.getElementById('loginPassword').value;try{const r=await fetch('/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})});const d=await r.json();if(d.success){currentUser=d;showMainApp();}else{showError(d.error);}}catch(err){showError('Ошибка соединения');}});r.addEventListener('submit',async e=>{e.preventDefault();const u=document.getElementById('regUsername').value,em=document.getElementById('regEmail').value,p=document.getElementById('regPassword').value;try{const r=await fetch('/api/register',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,email:em,password:p})});const d=await r.json();if(d.success){currentUser=d;showMainApp();}else{showError(d.error);}}catch(err){showError('Ошибка соединения');}});}
        function showError(m){document.getElementById('authError').textContent=m;}
        async function checkAuth(){try{const r=await fetch('/api/me'),d=await r.json();if(d.loggedIn){currentUser=d;showMainApp();}else{document.getElementById('authModal').style.display='flex';}}catch(e){document.getElementById('authModal').style.display='flex';}}
        function showMainApp(){document.getElementById('authModal').style.display='none';document.getElementById('mainApp').style.display='block';document.getElementById('profileName').textContent=currentUser.username;document.getElementById('badgesPageName').textContent=currentUser.username;document.getElementById('chatUsername').textContent=currentUser.username;if(currentUser.isOwner){const n=document.getElementById('navTabs');if(!document.querySelector('[data-tab="users"]')){const u=document.createElement('button');u.className='nav-tab admin-tab';u.dataset.tab='users';u.innerHTML='<i class="fas fa-users"></i> Users';n.appendChild(u);initNavigation();}}updateBadges();initChat();initPlayer();init3DTilt();renderProducts();renderFAQ();renderContacts();renderBadges();initCart();initNavigation();initReviews();}
        function initNavigation(){document.querySelectorAll('.nav-tab').forEach(t=>{t.addEventListener('click',()=>{const d=t.dataset.tab;document.querySelectorAll('.nav-tab').forEach(x=>x.classList.remove('active'));document.querySelectorAll('.tab-content').forEach(x=>x.classList.remove('active'));t.classList.add('active');document.getElementById(d).classList.add('active');if(d==='users'&&currentUser?.isOwner)loadAdminUsers();if(d==='reviews')loadReviews();});});}
        function initPlayer(){audio=new Audio();audio.crossOrigin="anonymous";loadTrack(0);initVisualizer();document.getElementById('playBtn').addEventListener('click',togglePlay);document.getElementById('nextBtn').addEventListener('click',()=>changeTrack(1));document.getElementById('prevBtn').addEventListener('click',()=>changeTrack(-1));document.getElementById('volumeSlider').addEventListener('input',updateVolume);document.getElementById('progressContainer').addEventListener('click',seek);audio.addEventListener('timeupdate',updateProgress);audio.addEventListener('ended',()=>changeTrack(1));audio.addEventListener('loadedmetadata',()=>{document.getElementById('duration').textContent=formatTime(audio.duration);});}
        function initVisualizer(){const c=document.getElementById('visualizer');c.innerHTML='';for(let i=0;i<20;i++){const b=document.createElement('div');b.className='visualizer-bar';b.style.height='3px';c.appendChild(b);}}
        function initAudioContext(){if(!audioContext){audioContext=new(window.AudioContext||window.webkitAudioContext)();analyser=audioContext.createAnalyser();analyser.fftSize=64;const s=audioContext.createMediaElementSource(audio);s.connect(analyser);analyser.connect(audioContext.destination);}}
        function animateVisualizer(){if(!isPlaying||!analyser)return;const d=new Uint8Array(analyser.frequencyBinCount);analyser.getByteFrequencyData(d);document.querySelectorAll('.visualizer-bar').forEach((b,i)=>{b.style.height=Math.max(3,(d[i*2]/255)*50)+'px';});requestAnimationFrame(animateVisualizer);}
        function loadTrack(i){currentTrack=i;const t=playlist[i];document.getElementById('trackTitle').textContent=t.title;document.getElementById('trackArtist').textContent=t.artist;document.getElementById('coverImage').style.backgroundImage=`url('${t.cover}')`;audio.src=t.audio;if(isPlaying){audio.play();initAudioContext();animateVisualizer();}}
        function togglePlay(){isPlaying=!isPlaying;const i=document.getElementById('playIcon'),c=document.getElementById('coverContainer');if(isPlaying){audio.play();i.classList.replace('fa-play','fa-pause');c.classList.add('playing');initAudioContext();animateVisualizer();}else{audio.pause();i.classList.replace('fa-pause','fa-play');c.classList.remove('playing');}}
        function changeTrack(d){currentTrack=(currentTrack+d+playlist.length)%playlist.length;loadTrack(currentTrack);}
        function updateVolume(e){audio.volume=e.target.value/100;}
        function updateProgress(){const p=(audio.currentTime/audio.duration)*100||0;document.getElementById('progressBarPlayer').style.width=p+'%';document.getElementById('currentTime').textContent=formatTime(audio.currentTime);}
        function seek(e){const r=e.currentTarget.getBoundingClientRect();const p=(e.clientX-r.left)/r.width;if(audio.duration)audio.currentTime=p*audio.duration;}
        function formatTime(s){if(isNaN(s))return'0:00';const m=Math.floor(s/60);const sec=Math.floor(s%60);return`${m}:${sec.toString().padStart(2,'0')}`;}
        function init3DTilt(){document.querySelectorAll('.music-player,.product-card,.faq-card,.contact-card').forEach(c=>{c.addEventListener('mousemove',e=>{const r=c.getBoundingClientRect();const x=e.clientX-r.left,y=e.clientY-r.top;const rx=(y-r.height/2)/10,ry=(r.width/2-x)/10;c.style.transform=`perspective(1000px) rotateX(${rx}deg) rotateY(${ry}deg) scale3d(1.02,1.02,1.02)`;});c.addEventListener('mouseleave',()=>{c.style.transform='perspective(1000px) rotateX(0) rotateY(0) scale3d(1,1,1)';});});}
        function initChat(){socket=io();socket.emit('joinChat',{username:currentUser.username});socket.on('chatHistory',m=>{const c=document.getElementById('chatMessages');c.innerHTML='';m.forEach(x=>appendMessage(x));});socket.on('newMessage',m=>{appendMessage(m);if(m.username===currentUser.username){messageCount++;document.getElementById('statMessages').textContent=messageCount;}});socket.on('onlineList',u=>{const l=document.getElementById('onlineList'),c=document.getElementById('onlineCount');l.innerHTML='';c.textContent=u.length;u.forEach(x=>{const d=document.createElement('div');d.className='online-user';d.innerHTML=`<span class="online-indicator"></span>${x.username}${x.badges.map(b=>`<span class="badge badge-${b} badge-small"><i class="fas ${badgeInfo[b]?.icon||'fa-star'}"></i> ${badgeInfo[b]?.name||b}</span>`).join('')}`;l.appendChild(d);});});socket.on('error',d=>alert(d.message));socket.on('banned',()=>{alert('Вы были забанены');logout();});socket.on('badgeUpdate',b=>{currentUser.badges=b;updateBadges();});document.getElementById('sendBtn').addEventListener('click',sendMessage);document.getElementById('chatInput').addEventListener('keypress',e=>{if(e.key==='Enter')sendMessage();});updateChatLimitDisplay();}
        function updateChatLimitDisplay(){const i=document.getElementById('chatLimitInfo'),l=document.getElementById('messagesLeft');l.textContent=messagesRemaining;if(cooldownActive){i.classList.add('chat-limit-blocked');i.classList.remove('chat-limit-warning');}else if(messagesRemaining<=2){i.classList.add('chat-limit-warning');i.classList.remove('chat-limit-blocked');}else{i.classList.remove('chat-limit-warning','chat-limit-blocked');}}
        function startCooldown(){cooldownActive=true;let r=CHAT_COOLDOWN;document.getElementById('chatInput').disabled=true;document.getElementById('sendBtn').disabled=true;cooldownInterval=setInterval(()=>{r--;document.getElementById('cooldownTime').textContent=r;updateChatLimitDisplay();if(r<=0){clearInterval(cooldownInterval);cooldownActive=false;messagesRemaining=CHAT_LIMIT;document.getElementById('chatInput').disabled=false;document.getElementById('sendBtn').disabled=false;document.getElementById('cooldownTime').textContent='0';updateChatLimitDisplay();}},1000);}
        function containsLink(text){return urlRegex.test(text);}
        function sendMessage(){if(cooldownActive)return;const i=document.getElementById('chatInput'),t=i.value.trim();if(!t)return;if(t.length>200){alert('Сообщение слишком длинное (макс. 200 символов)');return;}if(containsLink(t)){alert('Ссылки запрещены в чате!');return;}const n=Date.now();if(n-lastMessageTime<1000){alert('Слишком быстро! Подождите секунду.');return;}lastMessageTime=n;if(socket){socket.emit('sendMessage',{text:t});i.value='';messagesRemaining--;updateChatLimitDisplay();if(messagesRemaining<=0)startCooldown();}}
        function appendMessage(m){const c=document.getElementById('chatMessages'),d=document.createElement('div');d.className=`chat-message ${m.username===currentUser.username?'own':'other'}`;const b=m.badges.map(x=>`<span class="badge badge-${x} badge-small"><i class="fas ${badgeInfo[x]?.icon||'fa-star'}"></i></span>`).join('');d.innerHTML=`<div class="chat-message-header"><span class="chat-message-username">${escapeHtml(m.username)}</span>${b}<span class="chat-message-time">${m.time}</span></div><div class="chat-message-text">${escapeHtml(m.text)}</div>`;c.appendChild(d);c.scrollTop=c.scrollHeight;}
        function escapeHtml(t){const d=document.createElement('div');d.textContent=t;return d.innerHTML;}
        function renderProducts(){renderProductGrid('programmingProducts',products.programming);renderProductGrid('designProducts',products.design);renderProductGrid('packetsProducts',products.packets);renderProductGrid('blackProducts',products.black,true);}
        function renderProductGrid(id,items,isBlack=false){const g=document.getElementById(id);if(!g)return;g.innerHTML=items.map(i=>`<div class="product-card ${isBlack?'black-card':''}"><div class="product-icon"><i class="fas ${i.icon}"></i></div><h3 class="product-title">${i.title}</h3><p class="product-desc">${i.desc}</p><div class="product-price">${i.price.toLocaleString()} ₽</div><button class="add-to-cart-btn" onclick="addToCart('${i.id}','${i.title}',${i.price})"><i class="fas fa-cart-plus"></i> В корзину</button></div>`).join('');}
        function initCart(){document.getElementById('cartBtn').addEventListener('click',openCart);updateCartCount();}
        function addToCart(id,t,p){if(cart.find(x=>x.id===id)){alert('Этот товар уже в корзине');return;}cart.push({id,title:t,price:p});localStorage.setItem('cart',JSON.stringify(cart));updateCartCount();const b=event.target,orig=b.innerHTML;b.innerHTML='<i class="fas fa-check"></i> Добавлено';setTimeout(()=>b.innerHTML=orig,1500);}
        function updateCartCount(){document.getElementById('cartCount').textContent=cart.length;}
        function openCart(){const m=document.getElementById('cartModal'),i=document.getElementById('cartItems');if(cart.length===0){i.innerHTML='<div class="empty-cart"><i class="fas fa-shopping-basket" style="font-size:3rem;margin-bottom:1rem;"></i><br>Корзина пуста</div>';}else{i.innerHTML=cart.map((x,idx)=>`<div class="cart-item"><div class="cart-item-info"><h4>${x.title}</h4><p>${x.price.toLocaleString()} ₽</p></div><button class="cart-item-remove" onclick="removeFromCart(${idx})"><i class="fas fa-trash"></i></button></div>`).join('');}document.getElementById('cartTotal').textContent=cart.reduce((s,x)=>s+x.price,0).toLocaleString()+' ₽';m.classList.add('active');}
        function closeCart(){document.getElementById('cartModal').classList.remove('active');}
        function removeFromCart(i){cart.splice(i,1);localStorage.setItem('cart',JSON.stringify(cart));updateCartCount();openCart();}
        function checkout(){if(cart.length===0)return;alert('Для оформления заказа свяжитесь с нами в Telegram: @fakelavv');}
        function renderFAQ(){const f=[{icon:'fa-clock',q:'Сколько выполняется заказ?',a:'От 1 часа до 24 часов. Срочные заказы +50% к стоимости.'},{icon:'fa-user-secret',q:'Насколько анонимно?',a:'Полная анонимность. Все данные шифруются и удаляются после работы.'},{icon:'fa-ban',q:'Возврат средств?',a:'ВОЗВРАТА НЕТ. Услуги цифровые, не подлежат возврату.'},{icon:'fa-headset',q:'Есть ли поддержка?',a:'Поддержка 24/7 в Telegram. Ответ за 5-15 минут.'},{icon:'fa-shield-alt',q:'Какие гарантии?',a:'Гарантия 14 дней на исправление ошибок.'},{icon:'fa-credit-card',q:'Способы оплаты?',a:'ЮMoney, карты, криптовалюта (BTC, USDT).'}];document.getElementById('faqGrid').innerHTML=f.map((x,i)=>`<div class="faq-card" style="animation-delay:${i*0.1}s"><h3><i class="fas ${x.icon}"></i> ${x.q}</h3><p>${x.a}</p></div>`).join('');}
        function renderContacts(){document.getElementById('contactsGrid').innerHTML=contacts.map(c=>`<a href="${c.url}" class="contact-card" target="_blank"><div class="contact-icon"><i class="${c.icon}"></i></div><div class="contact-title">${c.title}</div><div class="contact-value">${c.value}</div></a>`).join('');}
        function updateBadges(){const b=currentUser?.badges||['new'],h=b.map(x=>`<span class="badge badge-${x}"><i class="fas ${badgeInfo[x]?.icon||'fa-star'}"></i> ${badgeInfo[x]?.name||x}</span>`).join('');document.getElementById('profileBadges').innerHTML=h;document.getElementById('chatBadges').innerHTML=h;document.getElementById('badgesPageBadges').innerHTML=h;document.getElementById('statBadges').textContent=b.length;}
        function renderBadges(){document.getElementById('badgesGrid').innerHTML=Object.entries(badgeInfo).map(([k,v])=>`<div class="badge-item"><span class="badge badge-${k}"><i class="fas ${v.icon}"></i> ${v.name}</span><div class="badge-desc">${v.desc}</div></div>`).join('');}
        async function loadAdminUsers(){try{const r=await fetch('/api/admin/users'),d=await r.json();document.getElementById('totalUsers').textContent=d.users.length;document.getElementById('onlineUsersCount').textContent=d.users.filter(x=>x.online).length;document.getElementById('bannedUsersCount').textContent=d.users.filter(x=>x.banned).length;document.getElementById('adminUsersList').innerHTML=d.users.map(u=>`<div class="admin-user-card"><div class="admin-user-info"><div class="admin-user-avatar"><i class="fas fa-user"></i></div><div class="admin-user-details"><h4>${u.username}${u.online?'<span class="online-indicator"></span>':''}${u.badges.map(b=>`<span class="badge badge-${b} badge-small"><i class="fas ${badgeInfo[b]?.icon||'fa-star'}"></i></span>`).join('')}</h4><p>${u.email} | IP: ${u.ips?.[0]||'N/A'} | Сообщений: ${u.messagesCount||0}</p></div></div><div class="admin-user-actions">${u.banned?`<button class="admin-btn admin-btn-mute" onclick="adminAction('unban','${u.username}')">Разбанить</button>`:`<button class="admin-btn admin-btn-ban" onclick="adminAction('ban','${u.username}')">Забанить</button>`}${u.muted?`<button class="admin-btn admin-btn-mute" onclick="adminAction('unmute','${u.username}')">Размутить</button>`:`<button class="admin-btn admin-btn-mute" onclick="adminAction('mute','${u.username}')">Замутить</button>`}<button class="admin-btn admin-btn-delete" onclick="adminAction('delete','${u.username}')">Удалить</button><button class="admin-btn admin-btn-badge" onclick="openBadgeModal('${u.username}')">Бейджик</button></div></div>`).join('');}catch(e){console.error(e);}}
        async function adminAction(a,u){if(!confirm(`Вы уверены, что хотите ${a} пользователя ${u}?`))return;try{const r=await fetch('/api/admin/action',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:a,targetUsername:u})}),d=await r.json();if(d.success)loadAdminUsers();else alert(d.error);}catch(e){alert('Ошибка выполнения действия');}}
        function openBadgeModal(u){selectedUserForBadge=u;selectedBadge=null;document.getElementById('badgeSelectGrid').innerHTML=Object.entries(badgeInfo).map(([k,v])=>`<div class="badge-select-item" onclick="selectBadge('${k}',this)"><span class="badge badge-${k}"><i class="fas ${v.icon}"></i> ${v.name}</span><div style="font-size:0.75rem;color:#888;margin-top:0.3rem;">${v.desc}</div></div>`).join('');document.getElementById('badgeSelectModal').classList.add('active');}
        function closeBadgeModal(){document.getElementById('badgeSelectModal').classList.remove('active');selectedUserForBadge=null;selectedBadge=null;}
        function selectBadge(b,e){selectedBadge=b;document.querySelectorAll('.badge-select-item').forEach(x=>x.classList.remove('selected'));e.classList.add('selected');}
        async function giveSelectedBadge(){if(!selectedBadge||!selectedUserForBadge){alert('Выберите бейджик');return;}try{const r=await fetch('/api/admin/badge',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'give',targetUsername:selectedUserForBadge,badge:selectedBadge})}),d=await r.json();if(d.success){alert(`Бейджик ${badgeInfo[selectedBadge].name} выдан ${selectedUserForBadge}`);closeBadgeModal();loadAdminUsers();}else alert(d.error);}catch(e){alert('Ошибка выдачи бейджика');}}
        async function removeSelectedBadge(){if(!selectedBadge||!selectedUserForBadge){alert('Выберите бейджик');return;}try{const r=await fetch('/api/admin/badge',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'remove',targetUsername:selectedUserForBadge,badge:selectedBadge})}),d=await r.json();if(d.success){alert(`Бейджик ${badgeInfo[selectedBadge].name} удален у ${selectedUserForBadge}`);closeBadgeModal();loadAdminUsers();}else alert(d.error);}catch(e){alert('Ошибка удаления бейджика');}}
        
        function initReviews(){const stars=document.querySelectorAll('#ratingInput .star-btn');stars.forEach(s=>{s.addEventListener('click',()=>{const r=parseInt(s.dataset.rating);selectedRating=r;stars.forEach((st,idx)=>{if(idx<r)st.classList.add('active');else st.classList.remove('active');});});});const editStars=document.querySelectorAll('#editRatingInput .star-btn');editStars.forEach(s=>{s.addEventListener('click',()=>{const r=parseInt(s.dataset.rating);editingRating=r;editStars.forEach((st,idx)=>{if(idx<r)st.classList.add('active');else st.classList.remove('active');});});});}
        let editingRating=0;
        async function loadReviews(){try{const r=await fetch('/api/reviews'),d=await r.json();renderReviews(d.reviews,d.userReview);updateReviewStats(d.reviews);if(d.userReview){document.getElementById('addReviewForm').style.display='none';}else{document.getElementById('addReviewForm').style.display='block';selectedRating=0;document.querySelectorAll('#ratingInput .star-btn').forEach(s=>s.classList.remove('active'));document.getElementById('reviewText').value='';}}catch(e){console.error(e);}}
        function renderReviews(reviews,userReview){const g=document.getElementById('reviewsGrid');let html='';if(userReview){html+=createReviewCard(userReview,true);}reviews.forEach(r=>{if(!userReview||r.id!==userReview.id){html+=createReviewCard(r,false);}});g.innerHTML=html||'<div style="text-align:center;color:#888;padding:3rem;">Пока нет отзывов. Будьте первым!</div>';}
        function createReviewCard(r,isOwner){const date=new Date(r.date).toLocaleDateString('ru-RU');const stars=Array(5).fill(0).map((_,i)=>`<i class="fas fa-star ${i<r.rating?'':'empty'}"></i>`).join('');return`<div class="review-card ${r.isAdminEdit?'admin-review':''}" data-id="${r.id}"><div class="review-header"><div class="review-user"><div class="review-avatar"><i class="fas fa-user"></i></div><div><div class="review-username">${escapeHtml(r.username)}</div><div class="review-date">${date}${r.isAdminEdit?' (изменено админом)':''}</div></div></div><div class="review-rating">${stars}</div></div><div class="review-text">${escapeHtml(r.text||'Без комментария')}</div>${(isOwner||currentUser?.isOwner)?`<div class="review-actions">${currentUser?.isOwner?`<button class="review-btn edit" onclick="openEditReviewModal('${r.id}',${r.rating},'${escapeHtml(r.text||'')}')">Изменить</button><button class="review-btn delete" onclick="deleteReview('${r.id}')">Удалить</button>`:`<button class="review-btn delete" onclick="deleteReview('${r.id}')">Удалить</button>`}</div>`:''}</div>`;}
        function updateReviewStats(reviews){if(!reviews.length){document.getElementById('avgRating').textContent='0.0';document.getElementById('totalReviews').textContent='0';document.getElementById('fiveStarPercent').textContent='0%';return;}const avg=(reviews.reduce((s,r)=>s+r.rating,0)/reviews.length).toFixed(1);const fiveStar=Math.round((reviews.filter(r=>r.rating===5).length/reviews.length)*100);document.getElementById('avgRating').textContent=avg;document.getElementById('totalReviews').textContent=reviews.length;document.getElementById('fiveStarPercent').textContent=fiveStar+'%';}
        async function submitReview(){if(selectedRating===0){alert('Выберите оценку от 1 до 5 звёзд');return;}const text=document.getElementById('reviewText').value.trim();try{const r=await fetch('/api/reviews',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({rating:selectedRating,text:text})});const d=await r.json();if(d.success){loadReviews();}else{alert(d.error);}}catch(e){alert('Ошибка отправки отзыва');}}
        async function deleteReview(id){if(!confirm('Удалить этот отзыв?'))return;try{const r=await fetch(`/api/reviews/${id}`,{method:'DELETE'});const d=await r.json();if(d.success){loadReviews();}else{alert(d.error);}}catch(e){alert('Ошибка удаления отзыва');}}
        function openEditReviewModal(id,rating,text){editingReviewId=id;editingRating=rating;document.getElementById('editReviewText').value=text.replace(/\\n/g,'\n');const stars=document.querySelectorAll('#editRatingInput .star-btn');stars.forEach((s,idx)=>{if(idx<rating)s.classList.add('active');else s.classList.remove('active');});document.getElementById('editReviewModal').classList.add('active');}
        function closeEditReviewModal(){document.getElementById('editReviewModal').classList.remove('active');editingReviewId=null;editingRating=0;}
        async function saveReviewEdit(){if(editingRating===0){alert('Выберите оценку');return;}const text=document.getElementById('editReviewText').value.trim();try{const r=await fetch(`/api/reviews/${editingReviewId}`,{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({rating:editingRating,text:text})});const d=await r.json();if(d.success){closeEditReviewModal();loadReviews();}else{alert(d.error);}}catch(e){alert('Ошибка обновления отзыва');}}
        async function logout(){await fetch('/api/logout',{method:'POST'});localStorage.removeItem('cart');location.reload();}
        document.getElementById('cartModal').addEventListener('click',e=>{if(e.target.id==='cartModal')closeCart();});
        document.getElementById('badgeSelectModal').addEventListener('click',e=>{if(e.target.id==='badgeSelectModal')closeBadgeModal();});
        document.getElementById('editReviewModal').addEventListener('click',e=>{if(e.target.id==='editReviewModal')closeEditReviewModal();});
    </script>
</body>
</html>
